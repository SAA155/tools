<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IP地址查询工具</title>
    <link rel="icon" href="https://vip.123pan.cn/1813813253/cdn/logo/1.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
        }
        .glass {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 bg-slate-50 dark:bg-slate-900 transition-colors duration-300">

    <!-- 主应用容器 -->
    <!-- Light: White glass, Slate border, Dark text -->
    <!-- Dark: Dark glass, White border, White text -->
    <div class="w-full max-w-md rounded-3xl p-6 glass bg-white/80 dark:bg-black/40 border border-slate-200 dark:border-white/10 text-slate-800 dark:text-white shadow-2xl shadow-slate-200/50 dark:shadow-black/50 space-y-6">

        <h1 class="text-3xl font-bold text-center tracking-wider text-slate-900 dark:text-white">IP 查询工具</h1>
        
        <!-- 查询输入框 -->
        <div class="flex items-center gap-3">
            <input type="text" id="ip-input" placeholder="输入IP地址，留空则查自己" 
                   class="w-full px-4 py-3 bg-white dark:bg-white/10 border border-slate-200 dark:border-white/20 rounded-xl focus:ring-2 focus:ring-indigo-500/50 focus:outline-none transition placeholder:text-slate-400 dark:placeholder:text-gray-400 text-slate-800 dark:text-white">
            <button id="query-btn" class="px-5 py-3 font-semibold bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl active:scale-95 transition-all duration-150 shadow-md shadow-indigo-200 dark:shadow-none">查询</button>
        </div>

        <!-- 结果显示区 -->
        <div id="result-container" class="space-y-3 pt-3">
            <!-- 状态或结果将动态插入这里 -->
             <div id="status" class="text-center py-10">
                <p class="text-lg text-slate-500 dark:text-white/60">请输入IP地址进行查询</p>
            </div>
        </div>

    </div>

    <script>
        // 自动适配深色模式
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }

        const ipInput = document.getElementById('ip-input');
        const queryBtn = document.getElementById('query-btn');
        const resultContainer = document.getElementById('result-container');
        
        // 创建结果行
        const createResultRow = (label, value, delay) => {
            const row = document.createElement('div');
            // Light: Slate-50 bg, Dark: White/10 bg
            row.className = 'fade-in flex justify-between items-center p-3 bg-slate-100 dark:bg-white/10 rounded-lg border border-slate-100 dark:border-transparent';
            row.style.opacity = '0'; 
            row.style.animationDelay = `${delay}ms`;
            
            const labelSpan = document.createElement('span');
            labelSpan.className = 'font-semibold text-slate-500 dark:text-white/70 text-sm';
            labelSpan.textContent = label;
            
            const valueSpan = document.createElement('span');
            valueSpan.className = 'font-medium text-right break-all text-slate-800 dark:text-white';
            valueSpan.textContent = value || 'N/A';
            
            row.appendChild(labelSpan);
            row.appendChild(valueSpan);
            
            return row;
        };
        
        // 显示结果
        const displayResults = (data) => {
            resultContainer.innerHTML = ''; 
            
            const fields = [
                { label: '查询 IP', value: data.ip },
                { label: '城市', value: data.city },
                { label: '地区', value: data.region },
                { label: '国家', value: data.country },
                { label: '经纬度', value: data.loc },
                { label: '运营商', value: data.org },
                { label: '时区', value: data.timezone },
            ];

            fields.forEach((field, index) => {
                const row = createResultRow(field.label, field.value, index * 70);
                resultContainer.appendChild(row);
            });
        };

        // 显示状态消息
        const showStatusMessage = (message, isError = false) => {
            resultContainer.innerHTML = '';
            const statusDiv = document.createElement('div');
            statusDiv.id = 'status';
            statusDiv.className = 'text-center py-10';
            const p = document.createElement('p');
            p.className = `text-lg ${isError ? 'text-red-500 dark:text-red-300' : 'text-slate-500 dark:text-white/60'}`;
            p.textContent = message;
            statusDiv.appendChild(p);
            resultContainer.appendChild(statusDiv);
        };

        // 查询IP信息
        const queryIP = async (ip = '') => {
            showStatusMessage('正在查询...');
            
            try {
                const response = await fetch(`https://ipinfo.io/${ip}/json`);
                if (!response.ok) {
                    if (response.status === 404) throw new Error('找不到该IP地址的信息。');
                    throw new Error(`网络请求失败 (${response.status})`);
                }
                const data = await response.json();
                if (data.bogon) throw new Error('这是一个保留或无效的IP地址。');
                
                ipInput.value = data.ip; 
                displayResults(data);

            } catch (error) {
                showStatusMessage(error.message, true);
            }
        };

        queryBtn.addEventListener('click', () => queryIP(ipInput.value.trim()));
        ipInput.addEventListener('keyup', (event) => {
            if (event.key === 'Enter') queryIP(ipInput.value.trim());
        });

        window.addEventListener('load', () => queryIP());
    </script>
</body>
</html>